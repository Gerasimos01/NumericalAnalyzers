## 2. Dynamic Analyzers

### 2.1 Newmark's Method for structural problems

Equation of equilibrium that governs the dynamic response of a linear system:

<a href="https://www.codecogs.com/eqnedit.php?latex=\mathbf{M}&space;\mathbf{\ddot{U}}&space;&plus;&space;\mathbf{C}&space;\mathbf{\dot{U}}&space;&plus;&space;\mathbf{K}&space;\mathbf{U}&space;=&space;\mathbf{R}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\mathbf{M}&space;\mathbf{\ddot{U}}&space;&plus;&space;\mathbf{C}&space;\mathbf{\dot{U}}&space;&plus;&space;\mathbf{K}&space;\mathbf{U}&space;=&space;\mathbf{R}" title="\mathbf{M} \mathbf{\ddot{U}} + \mathbf{C} \mathbf{\dot{U}} + \mathbf{K} \mathbf{U} = \mathbf{R}" /></a>

where **M**, **C** and **K** are the mass, damping and stiffness matrices and **U** is the displacement
vector.

Substituting the inertia forces, the damping forces and the elastic forces, the equation of equilibrium
can be written as:

<a href="https://www.codecogs.com/eqnedit.php?latex=\mathbf{F}_{I}(t)&space;&plus;&space;\mathbf{F}_{D}(t)&space;&plus;&space;\mathbf{F}_{E}(t)&space;=&space;\mathbf{R}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\mathbf{F}_{I}(t)&space;&plus;&space;\mathbf{F}_{D}(t)&space;&plus;&space;\mathbf{F}_{E}(t)&space;=&space;\mathbf{R}" title="\mathbf{F}_{I}(t) + \mathbf{F}_{D}(t) + \mathbf{F}_{E}(t) = \mathbf{R}" /></a>

For the solution of the dynamic system, we use the Newmark direct integration scheme, that makes the following assumptions:

<a href="https://www.codecogs.com/eqnedit.php?latex=^{t&plus;\Delta&space;t}{\mathbf{\dot{U}}}&space;=&space;^{t}{\mathbf{\dot{U}}}&space;&plus;&space;\left[(1-\delta)^{t}{\mathbf{\ddot{U}}}&space;&plus;&space;\delta&space;^{t&plus;\Delta&space;t}{\mathbf{\ddot{U}}}\right]&space;\Delta&space;t" target="_blank"><img src="https://latex.codecogs.com/gif.latex?^{t&plus;\Delta&space;t}{\mathbf{\dot{U}}}&space;=&space;^{t}{\mathbf{\dot{U}}}&space;&plus;&space;\left[(1-\delta)^{t}{\mathbf{\ddot{U}}}&space;&plus;&space;\delta&space;^{t&plus;\Delta&space;t}{\mathbf{\ddot{U}}}\right]&space;\Delta&space;t" title="^{t+\Delta t}{\mathbf{\dot{U}}} = ^{t}{\mathbf{\dot{U}}} + \left[(1-\delta)^{t}{\mathbf{\ddot{U}}} + \delta ^{t+\Delta t}{\mathbf{\ddot{U}}}\right] \Delta t" /></a>

<a href="https://www.codecogs.com/eqnedit.php?latex=^{t&plus;\Delta&space;t}{\mathbf{U}}&space;=&space;^{t}{\mathbf{U}}&space;&plus;&space;^{t}{\mathbf{\dot{U}}}\Delta&space;t&space;&plus;&space;\left[&space;\left(\frac{1}{2}-\alpha\right)&space;^{t}{\mathbf{\ddot{U}}}&space;&plus;&space;\alpha&space;^{t&plus;\Delta&space;t}{\mathbf{\ddot{U}}}&space;\right]&space;\Delta&space;t^{2}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?^{t&plus;\Delta&space;t}{\mathbf{U}}&space;=&space;^{t}{\mathbf{U}}&space;&plus;&space;^{t}{\mathbf{\dot{U}}}\Delta&space;t&space;&plus;&space;\left[&space;\left(\frac{1}{2}-\alpha\right)&space;^{t}{\mathbf{\ddot{U}}}&space;&plus;&space;\alpha&space;^{t&plus;\Delta&space;t}{\mathbf{\ddot{U}}}&space;\right]&space;\Delta&space;t^{2}" title="^{t+\Delta t}{\mathbf{U}} = ^{t}{\mathbf{U}} + ^{t}{\mathbf{\dot{U}}}\Delta t + \left[ \left(\frac{1}{2}-\alpha\right) ^{t}{\mathbf{\ddot{U}}} + \alpha ^{t+\Delta t}{\mathbf{\ddot{U}}} \right] \Delta t^{2}" /></a>

where <a href="https://www.codecogs.com/eqnedit.php?latex=\alpha" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\alpha" title="\alpha" /></a> and <a href="https://www.codecogs.com/eqnedit.php?latex=\delta" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\delta" title="\delta" /></a>  are parameters that can be determined to obtain integration accuracy and stability.
For the linear acceleration method, the parameters become <a href="https://www.codecogs.com/eqnedit.php?latex=\alpha=1/6" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\alpha=1/6" title="\alpha=1/6" /></a> and <a href="https://www.codecogs.com/eqnedit.php?latex=\delta=1/2" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\delta=1/2" title="\delta=1/2" /></a>, 
while for Newmark's method we have <a href="https://www.codecogs.com/eqnedit.php?latex=\alpha=1/4" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\alpha=1/4" title="\alpha=1/4" /></a> and <a href="https://www.codecogs.com/eqnedit.php?latex=\delta=1/2" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\delta=1/2" title="\delta=1/2" /></a>. 
According to above, the equation of equilibrium becomes:

<a href="https://www.codecogs.com/eqnedit.php?latex=\mathbf{M}&space;^{t&plus;\Delta&space;t}{\mathbf{\ddot{U}}}&plus;&space;\mathbf{C}&space;^{t&plus;\Delta&space;t}{\mathbf{\dot{U}}&space;}&plus;&space;\mathbf{K}&space;^{t&plus;\Delta&space;t}{\mathbf{U}}&space;=&space;^{t&plus;\Delta&space;t}{\mathbf{R}}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\mathbf{M}&space;^{t&plus;\Delta&space;t}{\mathbf{\ddot{U}}}&plus;&space;\mathbf{C}&space;^{t&plus;\Delta&space;t}{\mathbf{\dot{U}}&space;}&plus;&space;\mathbf{K}&space;^{t&plus;\Delta&space;t}{\mathbf{U}}&space;=&space;^{t&plus;\Delta&space;t}{\mathbf{R}}" title="\mathbf{M} ^{t+\Delta t}{\mathbf{\ddot{U}}}+ \mathbf{C} ^{t+\Delta t}{\mathbf{\dot{U}} }+ \mathbf{K} ^{t+\Delta t}{\mathbf{U}} = ^{t+\Delta t}{\mathbf{R}}" /></a>

Using the Trapezoidal rule, we solve for each time step:

<a href="https://www.codecogs.com/eqnedit.php?latex=\left(&space;\frac{4}{\Delta&space;t^{2}}&space;\mathbf{M}&space;&plus;&space;\frac{2}{\Delta&space;t}&space;\mathbf{C}&space;&plus;&space;\mathbf{K}\right)&space;^{t&plus;\Delta&space;t&space;}{\mathbf{U}}&space;=&space;^{t&plus;\Delta&space;t}{\mathbf{R}}&space;&plus;&space;\mathbf{M}&space;\left(\frac{4}{\Delta&space;t^{2}}&space;^{t}{\mathbf{U}}&space;&plus;&space;\frac{4}{\Delta&space;t}&space;^{t}{\mathbf{\dot{U}}}&space;&plus;&space;^{t}{\mathbf{\ddot{U}}}&space;\right)&space;&plus;&space;\mathbf{C}&space;\left(\frac{2}{\Delta&space;t}&space;^{t&space;}{\mathbf{U}}&space;&plus;&space;^{t}{\mathbf{\dot{U}}}&space;\right)" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\left(&space;\frac{4}{\Delta&space;t^{2}}&space;\mathbf{M}&space;&plus;&space;\frac{2}{\Delta&space;t}&space;\mathbf{C}&space;&plus;&space;\mathbf{K}\right)&space;^{t&plus;\Delta&space;t&space;}{\mathbf{U}}&space;=&space;^{t&plus;\Delta&space;t}{\mathbf{R}}&space;&plus;&space;\mathbf{M}&space;\left(\frac{4}{\Delta&space;t^{2}}&space;^{t}{\mathbf{U}}&space;&plus;&space;\frac{4}{\Delta&space;t}&space;^{t}{\mathbf{\dot{U}}}&space;&plus;&space;^{t}{\mathbf{\ddot{U}}}&space;\right)&space;&plus;&space;\mathbf{C}&space;\left(\frac{2}{\Delta&space;t}&space;^{t&space;}{\mathbf{U}}&space;&plus;&space;^{t}{\mathbf{\dot{U}}}&space;\right)" title="\left( \frac{4}{\Delta t^{2}} \mathbf{M} + \frac{2}{\Delta t} \mathbf{C} + \mathbf{K}\right) ^{t+\Delta t }{\mathbf{U}} = ^{t+\Delta t}{\mathbf{R}} + \mathbf{M} \left(\frac{4}{\Delta t^{2}} ^{t}{\mathbf{U}} + \frac{4}{\Delta t} ^{t}{\mathbf{\dot{U}}} + ^{t}{\mathbf{\ddot{U}}} \right) + \mathbf{C} \left(\frac{2}{\Delta t} ^{t }{\mathbf{U}} + ^{t}{\mathbf{\dot{U}}} \right)" /></a>

and then we can calculate <a href="https://www.codecogs.com/eqnedit.php?latex=^{t&plus;\Delta&space;t}{\mathbf{\ddot{U}}}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?^{t&plus;\Delta&space;t}{\mathbf{\ddot{U}}}" title="^{t+\Delta t}{\mathbf{\ddot{U}}}" /></a> and <a href="https://www.codecogs.com/eqnedit.php?latex=^{t&plus;\Delta&space;t}{\mathbf{\dot{U}}}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?^{t&plus;\Delta&space;t}{\mathbf{\dot{U}}}" title="^{t+\Delta t}{\mathbf{\dot{U}}}" /></a>.

**Implementation for Linear Dynamic Analysis**

The algorithm for the Newmark integration scheme can be summarized in the following step-by-step procedure:

A. *Initial calculations:*
  1.  Form stiffness matrix **K**, mass matrix **M** and damping matrix **C**.
  2.  Initialize <a href="https://www.codecogs.com/eqnedit.php?latex=^{0}{\mathbf{U}}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?^{0}{\mathbf{U}}" title="^{0}{\mathbf{U}}" /></a>, <a href="https://www.codecogs.com/eqnedit.php?latex=^{0}{\mathbf{\dot{U}}}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?^{0}{\mathbf{\dot{U}}}" title="^{0}{\mathbf{\dot{U}}}" /></a>, <a href="https://www.codecogs.com/eqnedit.php?latex=^{0}{\mathbf{\ddot{U}}}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?^{0}{\mathbf{\ddot{U}}}" title="^{0}{\mathbf{\ddot{U}}}" /></a>.
  3.  Select time step <a href="https://www.codecogs.com/eqnedit.php?latex=\Delta&space;t" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\Delta&space;t" title="\Delta t" /></a> and parameters <a href="https://www.codecogs.com/eqnedit.php?latex=\delta&space;\geq&space;0.50" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\delta&space;\geq&space;0.50" title="\delta \geq 0.50" /></a>, <a href="https://www.codecogs.com/eqnedit.php?latex=\alpha&space;\geq&space;0.25(0.5&plus;\delta)^{2}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\alpha&space;\geq&space;0.25(0.5&plus;\delta)^{2}" title="\alpha \geq 0.25(0.5+\delta)^{2}" /></a>.
  4.  Calculate integration constants:
  
  <a href="https://www.codecogs.com/eqnedit.php?latex=\alpha_{0}&space;=&space;\frac{1}{\alpha&space;\Delta&space;t^{2}}$;&space;$\alpha_{1}&space;=&space;\frac{\delta}{\alpha&space;\Delta&space;t}$;&space;$\alpha_{2}&space;=&space;\frac{1}{\alpha&space;\Delta&space;t}$;&space;$\alpha_{3}&space;=&space;\frac{1}{2\alpha}-1" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\alpha_{0}&space;=&space;\frac{1}{\alpha&space;\Delta&space;t^{2}}$;&space;$\alpha_{1}&space;=&space;\frac{\delta}{\alpha&space;\Delta&space;t}$;&space;$\alpha_{2}&space;=&space;\frac{1}{\alpha&space;\Delta&space;t}$;&space;$\alpha_{3}&space;=&space;\frac{1}{2\alpha}-1" title="\alpha_{0} = \frac{1}{\alpha \Delta t^{2}}$; $\alpha_{1} = \frac{\delta}{\alpha \Delta t}$; $\alpha_{2} = \frac{1}{\alpha \Delta t}$; $\alpha_{3} = \frac{1}{2\alpha}-1" /></a>
  <a href="https://www.codecogs.com/eqnedit.php?latex=\alpha_{4}&space;=&space;\frac{\delta}{\alpha}-1$;&space;$\alpha_{5}=\frac{\Delta&space;t}{2}&space;\left(\frac{\delta}{\alpha}-2\right)$;&space;$\alpha_{6}=\Delta&space;t&space;(1-\delta)&space;$;&space;$\alpha_{7}&space;=&space;\delta&space;\Delta&space;t" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\alpha_{4}&space;=&space;\frac{\delta}{\alpha}-1$;&space;$\alpha_{5}=\frac{\Delta&space;t}{2}&space;\left(\frac{\delta}{\alpha}-2\right)$;&space;$\alpha_{6}=\Delta&space;t&space;(1-\delta)&space;$;&space;$\alpha_{7}&space;=&space;\delta&space;\Delta&space;t" title="\alpha_{4} = \frac{\delta}{\alpha}-1$; $\alpha_{5}=\frac{\Delta t}{2} \left(\frac{\delta}{\alpha}-2\right)$; $\alpha_{6}=\Delta t (1-\delta) $; $\alpha_{7} = \delta \Delta t" /></a>
  
  5.  Form effective stiffness matrix 
  
<a href="https://www.codecogs.com/eqnedit.php?latex=\mathbf{\hat{K}}&space;=&space;\mathbf{K}&plus;\alpha_{0}\mathbf{M}&plus;\alpha_{1}\mathbf{C}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\mathbf{\hat{K}}&space;=&space;\mathbf{K}&plus;\alpha_{0}\mathbf{M}&plus;\alpha_{1}\mathbf{C}" title="\mathbf{\hat{K}} = \mathbf{K}+\alpha_{0}\mathbf{M}+\alpha_{1}\mathbf{C}" /></a>
  
  6.   Triangularize:

<a href="https://www.codecogs.com/eqnedit.php?latex=\mathbf{\hat{K}}&space;=\mathbf{L}\mathbf{D}\mathbf{L}^{T}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\mathbf{\hat{K}}&space;=\mathbf{L}\mathbf{D}\mathbf{L}^{T}" title="\mathbf{\hat{K}} =\mathbf{L}\mathbf{D}\mathbf{L}^{T}" /></a>

B. *For each time step:*
  1.  Calculate effective loads:

<a href="https://www.codecogs.com/eqnedit.php?latex=^{t&plus;\Delta&space;t}{\mathbf{\hat{R}}}=&space;^{t&plus;\Delta&space;t}{\mathbf{R}}&plus;\mathbf{M}\left(\alpha_{0}&space;^{t}{\mathbf{U}}&space;&plus;&space;\alpha_{2}&space;^{t}{\mathbf{\dot{U}}}&space;&plus;&space;\alpha_{3}^{t}{\mathbf{\ddot{U}}}&space;\right)&space;&plus;&space;\mathbf{C}\left(&space;\alpha_{1}&space;^{t}{\mathbf{U}}&space;&plus;&space;\alpha_{4}&space;^{t}{\mathbf{\dot{U}}}&space;&plus;&space;\alpha_{5}^{t}{\mathbf{\ddot{U}}}&space;\right)" target="_blank"><img src="https://latex.codecogs.com/gif.latex?^{t&plus;\Delta&space;t}{\mathbf{\hat{R}}}=&space;^{t&plus;\Delta&space;t}{\mathbf{R}}&plus;\mathbf{M}\left(\alpha_{0}&space;^{t}{\mathbf{U}}&space;&plus;&space;\alpha_{2}&space;^{t}{\mathbf{\dot{U}}}&space;&plus;&space;\alpha_{3}^{t}{\mathbf{\ddot{U}}}&space;\right)&space;&plus;&space;\mathbf{C}\left(&space;\alpha_{1}&space;^{t}{\mathbf{U}}&space;&plus;&space;\alpha_{4}&space;^{t}{\mathbf{\dot{U}}}&space;&plus;&space;\alpha_{5}^{t}{\mathbf{\ddot{U}}}&space;\right)" title="^{t+\Delta t}{\mathbf{\hat{R}}}= ^{t+\Delta t}{\mathbf{R}}+\mathbf{M}\left(\alpha_{0} ^{t}{\mathbf{U}} + \alpha_{2} ^{t}{\mathbf{\dot{U}}} + \alpha_{3}^{t}{\mathbf{\ddot{U}}} \right) + \mathbf{C}\left( \alpha_{1} ^{t}{\mathbf{U}} + \alpha_{4} ^{t}{\mathbf{\dot{U}}} + \alpha_{5}^{t}{\mathbf{\ddot{U}}} \right)" /></a>

  2.  Calculate the displacements vector:

<a href="https://www.codecogs.com/eqnedit.php?latex=\mathbf{L}\mathbf{D}\mathbf{L}^{T}&space;\left(^{t&plus;\Delta&space;t}{\mathbf{U}}\right)&space;=&space;^{t&plus;\Delta&space;t}{\mathbf{\hat{R}}}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\mathbf{L}\mathbf{D}\mathbf{L}^{T}&space;\left(^{t&plus;\Delta&space;t}{\mathbf{U}}\right)&space;=&space;^{t&plus;\Delta&space;t}{\mathbf{\hat{R}}}" title="\mathbf{L}\mathbf{D}\mathbf{L}^{T} \left(^{t+\Delta t}{\mathbf{U}}\right) = ^{t+\Delta t}{\mathbf{\hat{R}}}" /></a><a href="https://www.codecogs.com/eqnedit.php?latex=\mathbf{L}\mathbf{D}\mathbf{L}^{T}&space;\left(^{t&plus;\Delta&space;t}{\mathbf{U}}\right)&space;=&space;^{t&plus;\Delta&space;t}{\mathbf{\hat{R}}}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\mathbf{L}\mathbf{D}\mathbf{L}^{T}&space;\left(^{t&plus;\Delta&space;t}{\mathbf{U}}\right)&space;=&space;^{t&plus;\Delta&space;t}{\mathbf{\hat{R}}}" title="\mathbf{L}\mathbf{D}\mathbf{L}^{T} \left(^{t+\Delta t}{\mathbf{U}}\right) = ^{t+\Delta t}{\mathbf{\hat{R}}}" /></a>

  3.  Calculate accelerations and velocities:

<a href="https://www.codecogs.com/eqnedit.php?latex=^{t&plus;\Delta&space;t}{}{\mathbf{\ddot{U}}}=\alpha_{0}&space;\left(^{t&plus;\Delta&space;t}{}{\mathbf{U}}-^{t}{}{\mathbf{U}}&space;\right)&space;-&space;\alpha_{2}&space;^{t}{}{\mathbf{\dot{U}}}&space;-&space;\alpha_{3}&space;^{t}{}{\mathbf{\ddot{U}}}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?^{t&plus;\Delta&space;t}{}{\mathbf{\ddot{U}}}=\alpha_{0}&space;\left(^{t&plus;\Delta&space;t}{}{\mathbf{U}}-^{t}{}{\mathbf{U}}&space;\right)&space;-&space;\alpha_{2}&space;^{t}{}{\mathbf{\dot{U}}}&space;-&space;\alpha_{3}&space;^{t}{}{\mathbf{\ddot{U}}}" title="^{t+\Delta t}{}{\mathbf{\ddot{U}}}=\alpha_{0} \left(^{t+\Delta t}{}{\mathbf{U}}-^{t}{}{\mathbf{U}} \right) - \alpha_{2} ^{t}{}{\mathbf{\dot{U}}} - \alpha_{3} ^{t}{}{\mathbf{\ddot{U}}}" /></a>

<a href="https://www.codecogs.com/eqnedit.php?latex=^{t&plus;\Delta&space;t}{}{\mathbf{\dot{U}}}&space;=&space;^{t}{}{\mathbf{\dot{U}}}&space;&plus;&space;\alpha_{6}&space;^{t}{}{\mathbf{\ddot{U}}}&space;&plus;&space;\alpha_{7}&space;^{t&plus;\Delta&space;t}{}{\mathbf{\ddot{U}}}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?^{t&plus;\Delta&space;t}{}{\mathbf{\dot{U}}}&space;=&space;^{t}{}{\mathbf{\dot{U}}}&space;&plus;&space;\alpha_{6}&space;^{t}{}{\mathbf{\ddot{U}}}&space;&plus;&space;\alpha_{7}&space;^{t&plus;\Delta&space;t}{}{\mathbf{\ddot{U}}}" title="^{t+\Delta t}{}{\mathbf{\dot{U}}} = ^{t}{}{\mathbf{\dot{U}}} + \alpha_{6} ^{t}{}{\mathbf{\ddot{U}}} + \alpha_{7} ^{t+\Delta t}{}{\mathbf{\ddot{U}}}" /></a>

**Implementation for Nonlinear Dynamic Analysis**

The solution of nonlinear dynamic system of equations can be calculated using Newmark's 
method combined with the incremental-iterative procedure of the Newton-Raphson method. 
For illustration here the modified Newton-Raphson iteration method without damping 
effects is demonstrated as:

<a href="https://www.codecogs.com/eqnedit.php?latex=\mathbf{M}^{t&plus;\Delta&space;t}{}{\mathbf{\ddot{U}}}^{(k)}&space;&plus;&space;\mathbf{K}^{t&plus;\Delta&space;t}{}{\mathbf{U}}^{(k)}&space;=&space;^{t&plus;\Delta&space;t}{}{\mathbf{\hat{R}}}&space;-&space;^{t&plus;\Delta&space;t}{}{\mathbf{F}}^{(k-1)}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\mathbf{M}^{t&plus;\Delta&space;t}{}{\mathbf{\ddot{U}}}^{(k)}&space;&plus;&space;\mathbf{K}^{t&plus;\Delta&space;t}{}{\mathbf{U}}^{(k)}&space;=&space;^{t&plus;\Delta&space;t}{}{\mathbf{\hat{R}}}&space;-&space;^{t&plus;\Delta&space;t}{}{\mathbf{F}}^{(k-1)}" title="\mathbf{M}^{t+\Delta t}{}{\mathbf{\ddot{U}}}^{(k)} + \mathbf{K}^{t+\Delta t}{}{\mathbf{U}}^{(k)} = ^{t+\Delta t}{}{\mathbf{\hat{R}}} - ^{t+\Delta t}{}{\mathbf{F}}^{(k-1)}" /></a>

<a href="https://www.codecogs.com/eqnedit.php?latex=^{t&plus;\Delta&space;t}{}{\mathbf{U}}^{(k)}&space;=&space;^{t&plus;\Delta&space;t}{}{\mathbf{U}}^{(k-1)}&space;&plus;&space;\Delta\mathbf{U}^{(k)}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?^{t&plus;\Delta&space;t}{}{\mathbf{U}}^{(k)}&space;=&space;^{t&plus;\Delta&space;t}{}{\mathbf{U}}^{(k-1)}&space;&plus;&space;\Delta\mathbf{U}^{(k)}" title="^{t+\Delta t}{}{\mathbf{U}}^{(k)} = ^{t+\Delta t}{}{\mathbf{U}}^{(k-1)} + \Delta\mathbf{U}^{(k)}" /></a>

Using the trapezoidal rule of time integration according to Newmark's method, we get the following assumptions:

<a href="https://www.codecogs.com/eqnedit.php?latex=^{t&plus;\Delta&space;t}{}{\mathbf{U}}&space;=&space;^{t}{}{\mathbf{U}}&space;&plus;&space;\frac{\Delta&space;t}{2}&space;\left(&space;^{t}{}{\mathbf{\dot{U}}}&space;&plus;&space;^{t&plus;\Delta&space;t}{}{\mathbf{\dot{U}}}&space;\right)" target="_blank"><img src="https://latex.codecogs.com/gif.latex?^{t&plus;\Delta&space;t}{}{\mathbf{U}}&space;=&space;^{t}{}{\mathbf{U}}&space;&plus;&space;\frac{\Delta&space;t}{2}&space;\left(&space;^{t}{}{\mathbf{\dot{U}}}&space;&plus;&space;^{t&plus;\Delta&space;t}{}{\mathbf{\dot{U}}}&space;\right)" title="^{t+\Delta t}{}{\mathbf{U}} = ^{t}{}{\mathbf{U}} + \frac{\Delta t}{2} \left( ^{t}{}{\mathbf{\dot{U}}} + ^{t+\Delta t}{}{\mathbf{\dot{U}}} \right)" /></a>

<a href="https://www.codecogs.com/eqnedit.php?latex=^{t&plus;\Delta&space;t}{}{\mathbf{\dot{U}}}&space;=&space;^{t}{}{\mathbf{\dot{U}}}&space;&plus;&space;\frac{\Delta&space;t}{2}&space;\left(&space;^{t}{}{\mathbf{\ddot{U}}}&space;&plus;&space;^{t&plus;\Delta&space;t}{}{\mathbf{\ddot{U}}}&space;\right)" target="_blank"><img src="https://latex.codecogs.com/gif.latex?^{t&plus;\Delta&space;t}{}{\mathbf{\dot{U}}}&space;=&space;^{t}{}{\mathbf{\dot{U}}}&space;&plus;&space;\frac{\Delta&space;t}{2}&space;\left(&space;^{t}{}{\mathbf{\ddot{U}}}&space;&plus;&space;^{t&plus;\Delta&space;t}{}{\mathbf{\ddot{U}}}&space;\right)" title="^{t+\Delta t}{}{\mathbf{\dot{U}}} = ^{t}{}{\mathbf{\dot{U}}} + \frac{\Delta t}{2} \left( ^{t}{}{\mathbf{\ddot{U}}} + ^{t+\Delta t}{}{\mathbf{\ddot{U}}} \right)" /></a>

According to the above we can calculate the accelerations vector, as:

<a href="https://www.codecogs.com/eqnedit.php?latex=^{t&plus;\Delta&space;t}{}{\mathbf{\ddot{U}}}^{(k)}&space;=&space;\frac{4}{\Delta&space;t^{2}}\left(^{t&plus;\Delta&space;t}{}{\mathbf{U}}^{(k-1)}&space;-&space;^{t}{}{\mathbf{U}}&space;&plus;&space;\Delta\mathbf{U}^{(k)}&space;\right)&space;-&space;\frac{4}{\Delta&space;t}^{t}{}{\mathbf{\dot{U}}}&space;-&space;^{t}{}{\mathbf{\ddot{U}}}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?^{t&plus;\Delta&space;t}{}{\mathbf{\ddot{U}}}^{(k)}&space;=&space;\frac{4}{\Delta&space;t^{2}}\left(^{t&plus;\Delta&space;t}{}{\mathbf{U}}^{(k-1)}&space;-&space;^{t}{}{\mathbf{U}}&space;&plus;&space;\Delta\mathbf{U}^{(k)}&space;\right)&space;-&space;\frac{4}{\Delta&space;t}^{t}{}{\mathbf{\dot{U}}}&space;-&space;^{t}{}{\mathbf{\ddot{U}}}" title="^{t+\Delta t}{}{\mathbf{\ddot{U}}}^{(k)} = \frac{4}{\Delta t^{2}}\left(^{t+\Delta t}{}{\mathbf{U}}^{(k-1)} - ^{t}{}{\mathbf{U}} + \Delta\mathbf{U}^{(k)} \right) - \frac{4}{\Delta t}^{t}{}{\mathbf{\dot{U}}} - ^{t}{}{\mathbf{\ddot{U}}}" /></a>

The solution can be calculated from the solution of the following system:

<a href="https://www.codecogs.com/eqnedit.php?latex=\mathbf{\hat{K}}&space;\Delta\mathbf{U}^{(k)}&space;=&space;^{t&plus;\Delta&space;t}{}{\mathbf{R}}&space;-&space;^{t&plus;\Delta&space;t}{}{\mathbf{F}}^{(k-1)}&space;-&space;\mathbf{M}&space;\left[\frac{4}{\Delta&space;t^{2}}\left(^{t&plus;\Delta&space;t}{}{\mathbf{U}}^{(k-1)}&space;-&space;^{t}{}{\mathbf{U}}\right)&space;-&space;\frac{4}{\Delta&space;t}&space;^{t}{}{\mathbf{\dot{U}}}&space;-&space;^{t}{}{\mathbf{\ddot{U}}}&space;\right]" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\mathbf{\hat{K}}&space;\Delta\mathbf{U}^{(k)}&space;=&space;^{t&plus;\Delta&space;t}{}{\mathbf{R}}&space;-&space;^{t&plus;\Delta&space;t}{}{\mathbf{F}}^{(k-1)}&space;-&space;\mathbf{M}&space;\left[\frac{4}{\Delta&space;t^{2}}\left(^{t&plus;\Delta&space;t}{}{\mathbf{U}}^{(k-1)}&space;-&space;^{t}{}{\mathbf{U}}\right)&space;-&space;\frac{4}{\Delta&space;t}&space;^{t}{}{\mathbf{\dot{U}}}&space;-&space;^{t}{}{\mathbf{\ddot{U}}}&space;\right]" title="\mathbf{\hat{K}} \Delta\mathbf{U}^{(k)} = ^{t+\Delta t}{}{\mathbf{R}} - ^{t+\Delta t}{}{\mathbf{F}}^{(k-1)} - \mathbf{M} \left[\frac{4}{\Delta t^{2}}\left(^{t+\Delta t}{}{\mathbf{U}}^{(k-1)} - ^{t}{}{\mathbf{U}}\right) - \frac{4}{\Delta t} ^{t}{}{\mathbf{\dot{U}}} - ^{t}{}{\mathbf{\ddot{U}}} \right]" /></a>

where:

<a href="https://www.codecogs.com/eqnedit.php?latex=\mathbf{\hat{K}}&space;=&space;^{t}{}{\mathbf{K}}&space;&plus;&space;\frac{4}{\Delta&space;t^{2}}\mathbf{M}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\mathbf{\hat{K}}&space;=&space;^{t}{}{\mathbf{K}}&space;&plus;&space;\frac{4}{\Delta&space;t^{2}}\mathbf{M}" title="\mathbf{\hat{K}} = ^{t}{}{\mathbf{K}} + \frac{4}{\Delta t^{2}}\mathbf{M}" /></a>

is the effective stiffness matrix.


### 2.2 Finite Difference Method for heat transfer problems

The transient heat conduction equation is given by:

<a href="https://www.codecogs.com/eqnedit.php?latex=\frac{\partial}{\partial&space;x}&space;\left&space;(&space;k_x(T)\frac{\partial&space;T}{\partial&space;x}&space;\right)&plus;\frac{\partial}{\partial&space;y}\left&space;(&space;k_y(T)\frac{\partial&space;T}{\partial&space;y}\right&space;)&plus;\frac{\partial}{\partial&space;z}\left&space;(&space;k_z(T)\frac{\partial&space;T}{\partial&space;z}\right&space;)&plus;Q=\rho&space;c&space;\frac{\partial&space;T}{\partial&space;t}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\frac{\partial}{\partial&space;x}&space;\left&space;(&space;k_x(T)\frac{\partial&space;T}{\partial&space;x}&space;\right)&plus;\frac{\partial}{\partial&space;y}\left&space;(&space;k_y(T)\frac{\partial&space;T}{\partial&space;y}\right&space;)&plus;\frac{\partial}{\partial&space;z}\left&space;(&space;k_z(T)\frac{\partial&space;T}{\partial&space;z}\right&space;)&plus;Q=\rho&space;c&space;\frac{\partial&space;T}{\partial&space;t}" title="\frac{\partial}{\partial x} \left ( k_x(T)\frac{\partial T}{\partial x} \right)+\frac{\partial}{\partial y}\left ( k_y(T)\frac{\partial T}{\partial y}\right )+\frac{\partial}{\partial z}\left ( k_z(T)\frac{\partial T}{\partial z}\right )+Q=\rho c \frac{\partial T}{\partial t}" /></a>

where <a href="https://www.codecogs.com/eqnedit.php?latex=\inline&space;T(x,y,z)" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\inline&space;T(x,y,z)" title="T(x,y,z)" /></a> is the temperature field, *Q* is 
the heat generation per unit volume and  <a href="https://www.codecogs.com/eqnedit.php?latex=\inline&space;k,\rho,c" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\inline&space;k,\rho,c" title="k,\rho,c" /></a> are the material's conductivity, density and specific heat capacity, respectively.

The boundary conditions of this type of problem are:

<a href="https://www.codecogs.com/eqnedit.php?latex=T=T_b&space;\&space;\&space;\&space;\text{on}&space;\&space;\&space;\Gamma_b" target="_blank"><img src="https://latex.codecogs.com/gif.latex?T=T_b&space;\&space;\&space;\&space;\text{on}&space;\&space;\&space;\Gamma_b" title="T=T_b \ \ \ \text{on} \ \ \Gamma_b" /></a>

and

<a href="https://www.codecogs.com/eqnedit.php?latex=k_x(T)\frac{\partial&space;T}{\partial&space;x}l&plus;k_y(T)\frac{\partial&space;T}{\partial&space;y}m&plus;k_z(T)\frac{\partial&space;T}{\partial&space;z}n&space;&plus;&space;q&space;&plus;h(T-T_a)&space;\&space;\&space;\&space;\text{on}&space;\&space;\&space;\Gamma_q" target="_blank"><img src="https://latex.codecogs.com/gif.latex?k_x(T)\frac{\partial&space;T}{\partial&space;x}l&plus;k_y(T)\frac{\partial&space;T}{\partial&space;y}m&plus;k_z(T)\frac{\partial&space;T}{\partial&space;z}n&space;&plus;&space;q&space;&plus;h(T-T_a)&space;\&space;\&space;\&space;\text{on}&space;\&space;\&space;\Gamma_q" title="k_x(T)\frac{\partial T}{\partial x}l+k_y(T)\frac{\partial T}{\partial y}m+k_z(T)\frac{\partial T}{\partial z}n + q +h(T-T_a) \ \ \ \text{on} \ \ \Gamma_q" /></a>

where, <a href="https://www.codecogs.com/eqnedit.php?latex=\inline&space;\Gamma_b&space;\bigcup&space;\Gamma_q=\Gamma&space;\&space;\&space;\text{and}&space;\&space;\&space;\Gamma_b&space;\bigcap&space;\Gamma_q=\emptyset" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\inline&space;\Gamma_b&space;\bigcup&space;\Gamma_q=\Gamma&space;\&space;\&space;\text{and}&space;\&space;\&space;\Gamma_b&space;\bigcap&space;\Gamma_q=\emptyset" title="\Gamma_b \bigcup \Gamma_q=\Gamma \ \ \text{and} \ \ \Gamma_b \bigcap \Gamma_q=\emptyset" /></a> with <a href="https://www.codecogs.com/eqnedit.php?latex=\inline&space;\Gamma" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\inline&space;\Gamma" title="\Gamma" /></a> representing the whole boundary.
Also, *l,m,n* are direction cosines, <a href="https://www.codecogs.com/eqnedit.php?latex=\inline&space;h" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\inline&space;h" title="h" /></a> is the heat transfer coefficient, <a href="https://www.codecogs.com/eqnedit.php?latex=\inline&space;T_a" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\inline&space;T_a" title="T_a" /></a> is the atmospheric temperature and <a href="https://www.codecogs.com/eqnedit.php?latex=\inline&space;q" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\inline&space;q" title="q" /></a> is the boundary heat flux. The initial condition for the problem is 

<a href="https://www.codecogs.com/eqnedit.php?latex=\inline&space;T=T_0&space;\&space;\&space;\&space;\text{at}&space;\&space;\&space;t=0.0" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\inline&space;T=T_0&space;\&space;\&space;\&space;\text{at}&space;\&space;\&space;t=0.0" title="T=T_0 \ \ \ \text{at} \ \ t=0.0" /></a>


It is now possible to solve the system, provided that appropriate spatial and temporal discretizations are available.
The Galerkin method can be used for the spatial approximation and the above equation becomes:

<a href="https://www.codecogs.com/eqnedit.php?latex=\mathbf{C}\dot{\mathbf{T}}&plus;\mathbf{K}\mathbf{T}=\mathbf{f}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\mathbf{C}\dot{\mathbf{T}}&plus;\mathbf{K}\mathbf{T}=\mathbf{f}" title="\mathbf{C}\dot{\mathbf{T}}+\mathbf{K}\mathbf{T}=\mathbf{f}" /></a>

with <a href="https://www.codecogs.com/eqnedit.php?latex=\inline&space;\mathbf{C}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\inline&space;\mathbf{C}" title="\mathbf{C}" /></a>, <a href="https://www.codecogs.com/eqnedit.php?latex=\inline&space;\mathbf{K}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\inline&space;\mathbf{K}" title="\mathbf{K}" /></a>
 and <a href="https://www.codecogs.com/eqnedit.php?latex=\inline&space;\mathbf{f}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\inline&space;\mathbf{f}" title="\mathbf{f}" /></a> being the capacity matrix, the conductivity matrix and the load vector. More specifically:


<a href="https://www.codecogs.com/eqnedit.php?latex=C_{ij}=\int_{\Omega}\rho&space;cN_iN_jd\Omega" target="_blank"><img src="https://latex.codecogs.com/gif.latex?C_{ij}=\int_{\Omega}\rho&space;cN_iN_jd\Omega" title="C_{ij}=\int_{\Omega}\rho cN_iN_jd\Omega" /></a>

<a href="https://www.codecogs.com/eqnedit.php?latex=K_{ij}=\int_{\Omega}&space;\left&space;[&space;k_x(T)&space;\frac{\partial&space;N_i}{\partial&space;x}\frac{\partial&space;N_j}{\partial&space;x}&plus;&space;k_y(T)&space;\frac{\partial&space;N_i}{\partial&space;y}\frac{\partial&space;N_j}{\partial&space;y}&plus;k_z(T)&space;\frac{\partial&space;N_i}{\partial&space;z}\frac{\partial&space;N_j}{\partial&space;z}&space;\right&space;]&space;d\Omega&space;&plus;&space;\int_{\Gamma}&space;h&space;N_i&space;N_j&space;d\Gamma" target="_blank"><img src="https://latex.codecogs.com/gif.latex?K_{ij}=\int_{\Omega}&space;\left&space;[&space;k_x(T)&space;\frac{\partial&space;N_i}{\partial&space;x}\frac{\partial&space;N_j}{\partial&space;x}&plus;&space;k_y(T)&space;\frac{\partial&space;N_i}{\partial&space;y}\frac{\partial&space;N_j}{\partial&space;y}&plus;k_z(T)&space;\frac{\partial&space;N_i}{\partial&space;z}\frac{\partial&space;N_j}{\partial&space;z}&space;\right&space;]&space;d\Omega&space;&plus;&space;\int_{\Gamma}&space;h&space;N_i&space;N_j&space;d\Gamma" title="K_{ij}=\int_{\Omega} \left [ k_x(T) \frac{\partial N_i}{\partial x}\frac{\partial N_j}{\partial x}+ k_y(T) \frac{\partial N_i}{\partial y}\frac{\partial N_j}{\partial y}+k_z(T) \frac{\partial N_i}{\partial z}\frac{\partial N_j}{\partial z} \right ] d\Omega + \int_{\Gamma} h N_i N_j d\Gamma" /></a>

<a href="https://www.codecogs.com/eqnedit.php?latex=f_i=\int_{\Omega}N_iQd\Omega-\int_{\Gamma_q}qN_id\Gamma_q&plus;\int_{\Gamma_q}hN_iT_ad\Gamma_q" target="_blank"><img src="https://latex.codecogs.com/gif.latex?f_i=\int_{\Omega}N_iQd\Omega-\int_{\Gamma_q}qN_id\Gamma_q&plus;\int_{\Gamma_q}hN_iT_ad\Gamma_q" title="f_i=\int_{\Omega}N_iQd\Omega-\int_{\Gamma_q}qN_id\Gamma_q+\int_{\Gamma_q}hN_iT_ad\Gamma_q" /></a>

or, in matrix form,

<a href="https://www.codecogs.com/eqnedit.php?latex=\mathbf{C}=\int_{\Omega}&space;\rho&space;c&space;\mathbf{N}^T&space;\mathbf{N}&space;d\Omega" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\mathbf{C}=\int_{\Omega}&space;\rho&space;c&space;\mathbf{N}^T&space;\mathbf{N}&space;d\Omega" title="\mathbf{C}=\int_{\Omega} \rho c \mathbf{N}^T \mathbf{N} d\Omega" /></a>

<a href="https://www.codecogs.com/eqnedit.php?latex=\mathbf{K}=\int_{\Omega}\mathbf{B}^T&space;\mathbf{D}&space;\mathbf{B}&space;d\Omega&plus;\int_{\Gamma}&space;h\mathbf{N}^T&space;\mathbf{N}&space;d\Gamma" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\mathbf{K}=\int_{\Omega}\mathbf{B}^T&space;\mathbf{D}&space;\mathbf{B}&space;d\Omega&plus;\int_{\Gamma}&space;h\mathbf{N}^T&space;\mathbf{N}&space;d\Gamma" title="\mathbf{K}=\int_{\Omega}\mathbf{B}^T \mathbf{D} \mathbf{B} d\Omega+\int_{\Gamma} h\mathbf{N}^T \mathbf{N} d\Gamma" /></a>

<a href="https://www.codecogs.com/eqnedit.php?latex=\mathbf{f}=\int_{\Omega}Q\mathbf{B}^Td\Omega-\int_{\Gamma_q}&space;q\mathbf{N}^T&space;d\Gamma_q&plus;\int_{\Gamma_q}&space;hT_a\mathbf{N}^T&space;d\Gamma_q" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\mathbf{f}=\int_{\Omega}Q\mathbf{B}^Td\Omega-\int_{\Gamma_q}&space;q\mathbf{N}^T&space;d\Gamma_q&plus;\int_{\Gamma_q}&space;hT_a\mathbf{N}^T&space;d\Gamma_q" title="\mathbf{f}=\int_{\Omega}Q\mathbf{B}^Td\Omega-\int_{\Gamma_q} q\mathbf{N}^T d\Gamma_q+\int_{\Gamma_q} hT_a\mathbf{N}^T d\Gamma_q" /></a>




For the solution of the dynamic system, we use a Finite Difference scheme, that makes the following assumptions:

<a href="https://www.codecogs.com/eqnedit.php?latex=\inline&space;\mathbf{C}\frac{\mathbf{T}^{n&plus;1}-\mathbf{T}^n}{\Delta&space;t}&plus;\mathbf{K}\left&space;(&space;\theta\mathbf{T}^{n&plus;1}&plus;(1-\theta)\mathbf{T}^n&space;\right&space;)=\theta&space;\mathbf{f}^{n&plus;1}&plus;(1-\theta)\mathbf{f}^n" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\inline&space;\mathbf{C}\frac{\mathbf{T}^{n&plus;1}-\mathbf{T}^n}{\Delta&space;t}&plus;\mathbf{K}\left&space;(&space;\theta\mathbf{T}^{n&plus;1}&plus;(1-\theta)\mathbf{T}^n&space;\right&space;)=\theta&space;\mathbf{f}^{n&plus;1}&plus;(1-\theta)\mathbf{f}^n" title="\mathbf{C}\frac{\mathbf{T}^{n+1}-\mathbf{T}^n}{\Delta t}+\mathbf{K}\left ( \theta\mathbf{T}^{n+1}+(1-\theta)\mathbf{T}^n \right )=\theta \mathbf{f}^{n+1}+(1-\theta)\mathbf{f}^n" /></a>

or

<a href="https://www.codecogs.com/eqnedit.php?latex=\inline&space;(\frac{1}{\Delta&space;t}\mathbf{C}&plus;\theta\mathbf{K})&space;\mathbf{T}^{n&plus;1}=\left&space;(&space;\frac{1}{\Delta&space;t}\mathbf{C}-(1-\theta)&space;\mathbf{K}&space;\right&space;)\mathbf{T}^n&plus;\left&space;(&space;\theta&space;\mathbf{f}^{n&plus;1}&space;&plus;&space;(1-\theta)\mathbf{f}^n&space;\right&space;)" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\inline&space;(\frac{1}{\Delta&space;t}\mathbf{C}&plus;\theta\mathbf{K})&space;\mathbf{T}^{n&plus;1}=\left&space;(&space;\frac{1}{\Delta&space;t}\mathbf{C}-(1-\theta)&space;\mathbf{K}&space;\right&space;)\mathbf{T}^n&plus;\left&space;(&space;\theta&space;\mathbf{f}^{n&plus;1}&space;&plus;&space;(1-\theta)\mathbf{f}^n&space;\right&space;)" title="(\frac{1}{\Delta t}\mathbf{C}+\theta\mathbf{K}) \mathbf{T}^{n+1}=\left ( \frac{1}{\Delta t}\mathbf{C}-(1-\theta) \mathbf{K} \right )\mathbf{T}^n+\left ( \theta \mathbf{f}^{n+1} + (1-\theta)\mathbf{f}^n \right )" /></a>

The above equation gives the nodal values of temperature at the <a href="https://www.codecogs.com/eqnedit.php?latex=\inline&space;n&plus;1" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\inline&space;n&plus;1" title="n+1" /></a> time level. By varying the parameter
<a href="https://www.codecogs.com/eqnedit.php?latex=\inline&space;\theta" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\inline&space;\theta" title="\theta" /></a> , different transient schemes can be constructed. For instance, <a href="https://www.codecogs.com/eqnedit.php?latex=\inline&space;\theta=0" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\inline&space;\theta=0" title="\theta=0" /></a> results in the
forward difference method (fully explicit), <a href="https://www.codecogs.com/eqnedit.php?latex=\inline&space;\theta=1" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\inline&space;\theta=1" title="\theta=1" /></a> in the backward difference method (fully implicit) and
<a href="https://www.codecogs.com/eqnedit.php?latex=\inline&space;\theta=0.5" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\inline&space;\theta=0.5" title="\theta=0.5" /></a> in the Crank-Nicolson method (semi-implicit).

**Implementation for Linear Dynamic Analysis**

The algorithm for the Finite Difference integration scheme can be summarized in the following step-by-step procedure:

A. *Initial calculations:*
  1.  Form conductivity matrix **K** and capacity matrix **C**
  2.  Initialize <a href="https://www.codecogs.com/eqnedit.php?latex=\inline&space;\mathbf{T}^0" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\inline&space;\mathbf{T}^0" title="\mathbf{T}^0" /></a>
  3.  Select time step <a href="https://www.codecogs.com/eqnedit.php?latex=\Delta&space;t" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\Delta&space;t" title="\Delta t" /></a> and parameter <a href="https://www.codecogs.com/eqnedit.php?latex=\inline&space;\theta" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\inline&space;\theta" title="\theta" /></a>
  4.  Form the effective matrix 
  
<a href="https://www.codecogs.com/eqnedit.php?latex=\inline&space;\hat{\mathbf{K}}=(\frac{1}{\Delta&space;t}\mathbf{C}&plus;\theta\mathbf{K})" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\inline&space;\hat{\mathbf{K}}=(\frac{1}{\Delta&space;t}\mathbf{C}&plus;\theta\mathbf{K})" title="\hat{\mathbf{K}}=(\frac{1}{\Delta t}\mathbf{C}+\theta\mathbf{K})" /></a>

B. *For each time step:*
  1.  Calculate effective loads:

<a href="https://www.codecogs.com/eqnedit.php?latex=\inline&space;\hat{\mathbf{f}}=\left&space;(&space;\frac{1}{\Delta&space;t}\mathbf{C}-(1-\theta)&space;\mathbf{K}&space;\right&space;)\mathbf{T}^n&plus;\left&space;(&space;\theta&space;\mathbf{f}^{n&plus;1}&space;&plus;&space;(1-\theta)\mathbf{f}^n&space;\right&space;)" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\inline&space;\hat{\mathbf{f}}=\left&space;(&space;\frac{1}{\Delta&space;t}\mathbf{C}-(1-\theta)&space;\mathbf{K}&space;\right&space;)\mathbf{T}^n&plus;\left&space;(&space;\theta&space;\mathbf{f}^{n&plus;1}&space;&plus;&space;(1-\theta)\mathbf{f}^n&space;\right&space;)" title="\hat{\mathbf{f}}=\left ( \frac{1}{\Delta t}\mathbf{C}-(1-\theta) \mathbf{K} \right )\mathbf{T}^n+\left ( \theta \mathbf{f}^{n+1} + (1-\theta)\mathbf{f}^n \right )" /></a>

  2.  Calculate the nodal temperatures at the <a href="https://www.codecogs.com/eqnedit.php?latex=\inline&space;n&plus;1" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\inline&space;n&plus;1" title="n+1" /></a> time increment:

<a href="https://www.codecogs.com/eqnedit.php?latex=\inline&space;\hat{\mathbf{K}}\mathbf{T}^{n&plus;1}=\hat{\mathbf{f}}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\inline&space;\hat{\mathbf{K}}\mathbf{T}^{n&plus;1}=\hat{\mathbf{f}}" title="\hat{\mathbf{K}}\mathbf{T}^{n+1}=\hat{\mathbf{f}}" /></a>

## References
[1] Finite Element Procedures, K-J. Bathe, Prentice Hall, 2nd edition, 2014.

[2] Fundamentals of the Finite Element Method for Heat and Fluid Flow, R. Lewis, P. Nithiarasu and K. Seetharamu, Wiley, 2004.
